<h1>Edit Device #{{ vm.prevState.id }}</h1>

<form name="deviceForm" ng-submit="vm.submitForm()" novalidate role="form">

  <div class="form-group" show-form-errors>
    <label class="control-label">ID</label>
    <input
      type="number"
      name="id"
      class="form-control"
      required
      min="1"
      max="255"
      ng-model="vm.device.id"
      tooltip="Device Unique ID (like address) between 1 and 255"
      tooltip-placement="right">
  </div>

  <div class="form-group" show-form-errors>
    <label class="control-label">Name</label>
    <input
      type="text"
      name="name"
      class="form-control"
      placeholder="Enter device name"
      required
      ng-model="vm.device.name"
      ng-pattern="/^[a-z0-9\_\- ]+$/i"
      tooltip="Examples: My first device, Kitchen node, Wireless board (allowed chars: [a-z0-9_- ])"
      tooltip-placement="right">
  </div>

  <div class="form-group" show-form-errors>
    <label class="control-label">Connection URI</label>
    <input
      type="text"
      name="netrouter"
      class="form-control"
      placeholder="How device will be connected to SmartAnthill?"
      required
      ng-model="vm.device.connectionUri"
      ng-pattern="/^serial\:\/\/[^\?]+(\?(\&?[a-z]+=[^\:]+)+)?$/"
      tooltip="Examples: serial:///dev/ttyUSB0, serial://COM1?baudrate=9600"
      tooltip-placement="right">
  </div>

  <div class="form-group" ng-class="{'has-success': vm.selectBoard.selected}" show-form-errors="vm.submitted && !vm.selectBoard.selected">
    <label class="control-label">Board</label>
    <ui-select ng-model="vm.selectBoard.selected" theme="bootstrap" ng-disabled="vm.device.bodyparts.length">
      <ui-select-match required placeholder="Select or search a board in the list...">{{$select.selected.name}}</ui-select-match>
      <ui-select-choices group-by="vm.boardGroupBy" repeat="item in vm.boards | filter: {name: $select.search}">
        <div ng-bind-html="item.name | highlight: $select.search"></div>
      </ui-select-choices>
    </ui-select>
  </div>

  <div ng-controller="DeviceEditBodyPartsController as bodyPartsVm"
       ng-include src="'views/device-edit-bodyparts.html'"></div>

  <div class="form-group" show-form-errors>
    <label class="control-label">Device is enabled</label>
    <div class="btn-group">
      <label class="btn btn-default" ng-model="vm.device.enabled" btn-radio="true">Yes</label>
      <label class="btn btn-default" ng-model="vm.device.enabled" btn-radio="false">No</label>
    </div>
  </div>

  <button type="submit" class="btn btn-primary" ng-disabled="vm.disableSubmit || deviceForm.$invalid || !vm.selectBoard.selected || !vm.device.bodyparts.length">Submit</button>
  <button type="button" class="btn btn-link" ng-click="vm.resetForm()">Reset</button>
</form>

<br class=clearfix>
